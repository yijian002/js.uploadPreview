/*
    uploadPreview.js
    @author Vic 
    https://github.com/yijian002/js.uploadPreview
*/

(function(d,e){"function"===typeof define&&define.amd?define("uploadPreview",d):e.uploadPreview=d()})(function(){function d(a){window.console&&window.console.error?window.console.error(a):window.opera&&window.opera.postError&&window.opera.postError(a)}function e(a,b){for(var f in b)b.hasOwnProperty(f)&&(a[f]=b[f]);return a}function l(a){var b=null;window.createObjectURL?b=window.createObjectURL(a):window.URL?b=window.URL.createObjectURL(a):window.webkitURL&&(b=window.webkitURL.createObjectURL(a));
return b}function m(a,b,f){window.addEventListener?a.addEventListener(b,f,!1):a["on"+b]=f}function h(a){return"string"===typeof a?document.getElementById(a):a}function k(a){g.style.backgroundImage="url("+a+")";g.style.backgroundSize="cover";g.style.backgroundPosition="center center"}var c={label_field:"",preview:"",img_type:["gif","jpeg","jpg","png"],callback:function(){},errorback:function(){}},g=null;return function(a){a&&"object"===typeof a&&e(c,a);(g=h(c.preview))?(a=h(c.label_field))?m(a,"change",
function(a){if(!this.value)return c.errorback(!1),d("Not found the value"),!1;if(!RegExp(".("+c.img_type.join("|")+")$","i").test(this.value.toLowerCase()))return c.errorback(!1),d("This file type is not supported"),!1;if(window.File&&window.FileList&&window.FileReader){var b=this.files;if(!b||!b.length)return c.errorback(!1),d("Not found the files"),!1;a=a.target;var e=new FileReader;e.onload=function(){k(e.result)};e.readAsDataURL(a.files[0])}else try{b=l(this.files[0]),k(b)}catch(n){this.select(),
a=document.selection.createRange().text,document.selection.empty(),g.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(sizingMethod=scale)",g.filters.item("DXImageTransform.Microsoft.AlphaImageLoader").src=a}"function"===typeof c.callback&&c.callback()}):d("Not found the option label_field"):d("Not found the option preview")}},window);